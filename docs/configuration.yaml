scrape:
  - resource: https://www.sneeuwhoogte.nl/overzicht/frankrijk/savoie/espace-killy/tignes
    scan_interval: 3600
    sensor:
      - name: "Resort Mountain Snow Depth Raw"
        select: "h2.summary_card__heights span.summary-card__label:contains('Berg') + span"

      - name: "Resort Valley Snow Depth Raw"
        select: "h2.summary_card__heights span.summary-card__label:contains('Dal') + span"

      - name: "Resort Last Snowfall Raw"
        select: "tr th:contains('Laatste sneeuwval') + td"

      - name: "Resort Snowfall Last 24h Raw"
        select: "tr th:contains('Laatste 24') + td"
    
      - name: "Resort Elevation Raw"
        select: "div.entry-header h6"
  - resource: https://www.sneeuwhoogte.nl/overzicht/frankrijk/savoie/espace-killy/tignes/weer
    scan_interval: 3600
    sensor:
      - name: "Resort Forecast Mountain Snow Raw"
        select: ".forecast__footer-value"
        index: 0

      - name: "Resort Forecast Valley Snow Raw"
        select: ".forecast__footer-value"
        index: 2

template:
  - sensor:
      - name: "Resort Mountain Snow Depth"
        unit_of_measurement: "cm"
        state_class: measurement
        state: >
            {% set v = states('sensor.resort_mountain_snow_depth_raw') %}
            {% if v not in ('unknown', 'unavailable', '') %}
              {% set nums = v | regex_findall('\d+') %}
              {{ nums[0] if nums | length > 0 else 0 }}
            {% else %}
              0
            {% endif %}

      - name: "Resort Valley Snow Depth"
        unit_of_measurement: "cm"
        state_class: measurement
        state: >
          {% set v = states('sensor.resort_valley_snow_depth_raw') %}
          {% if v not in ('unknown', 'unavailable', '') %}
            {% set nums = v | regex_findall('\d+') %}
            {{ nums[0] if nums | length > 0 else 0 }}
          {% else %}
            0
          {% endif %}

      - name: "Resort Snowfall Last 24h"
        unit_of_measurement: "cm"
        state_class: measurement
        state: >
          {% set v = states('sensor.resort_snowfall_last_24h_raw') %}
          {% if v not in ('unknown', 'unavailable', '') %}
            {% set nums = v | regex_findall('\d+') %}
            {{ nums[0] if nums | length > 0 else 0 }}
          {% else %}
            0
          {% endif %}

      - name: "Resort Forecast Mountain Snow (5d)"
        unit_of_measurement: "cm"
        state_class: measurement
        state: >
          {% set v = states('sensor.resort_forecast_mountain_snow_raw') %}
          {% set nums = v | regex_findall('\d+') %}
          {{ nums[0] if nums | length > 0 else 0 }}

      - name: "Resort Forecast Valley Snow (5d)"
        unit_of_measurement: "cm"
        state_class: measurement
        state: >
          {% set v = states('sensor.resort_forecast_valley_snow_raw') %}
          {% set nums = v | regex_findall('\d+') %}
          {{ nums[0] if nums | length > 0 else 0 }}

      - name: "Resort Valley Elevation"
        unit_of_measurement: "m"
        state_class: measurement
        state: >
          {% set v = states('sensor.resort_elevation_raw') %}
          {% if v not in ('unknown', 'unavailable', '') %}
            {% set nums = v | regex_findall('\d+') %}
            {{ nums[0] if nums | length > 0 else 0 }}
          {% else %}
            0
          {% endif %}
          
      - name: "Resort Mountain Elevation"
        unit_of_measurement: "m"
        state_class: measurement
        state: >
          {% set v = states('sensor.resort_elevation_raw') %}
          {% if v not in ('unknown', 'unavailable', '') %}
            {% set nums = v | regex_findall('\d+') %}
            {{ nums[1] if nums | length > 1 else 0 }}
          {% else %}
            0
          {% endif %}